<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <title>نموذج إرسال البيانات</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            font-family: "Tahoma", sans-serif;
            background: #f4f7f8;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            direction: rtl;
        }

        form {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            max-width: 1000px;
            width: 100%;
        }

        h2 {
            text-align: center;
            margin-bottom: 20px;
            color: #333;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px 20px;
        }

        @media (max-width: 700px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
        }

        .form-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
        }

        label {
            white-space: nowrap;
            font-weight: bold;
            flex: 1;
            text-align: right;
        }

        input,
        select {
            flex: 2;
            padding: 6px;
            border-radius: 6px;
            border: 1px solid #ccc;
            font-size: 14px;
            text-align: center;
        }

        button {
            display: block;
            width: 100%;
            padding: 12px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            margin-top: 20px;
            cursor: pointer;
        }

        button:hover {
            background: #45a049;
        }

        #status {
            text-align: center;
            margin-top: 15px;
            color: #333;
            font-weight: bold;
        }
    </style>
</head>

<body>

    <form id="myForm">
        <h2>نموذج إرسال البيانات</h2>

        <div class="form-grid">
            <div class="form-row">
                <label for="userId">رقم المستخدم</label>
                <input id="userId" name="المستخدم" type="text" required>
            </div>
            <div class="form-row">
                <label for="password">كلمة المرور</label>
                <input id="password" name="كلمة المرور" type="password" required>
            </div>

            <div class="form-row">
                <label for="idara">الإدارة</label>
                <select id="idara" name="الإدارة" required>
                    <option value="">اختر الإدارة</option>
                    <option>إدارة مكاتب الإشراف قسم الرجال</option>
                    <option>إدارة البرامج والقياس</option>
                    <option>إدارة مكاتب الإشراف قسم النساء</option>
                </select>
            </div>

            <div class="form-row">
                <label for="department">القسم</label>
                <select id="department" name="القسم" required>
                    <option value="">اختر القسم</option>
                    <option>مكتب الشمال - رجال</option>
                    <option>مكتب الوسط - رجال</option>
                    <option>مكتب الشرق - رجال</option>
                    <option>مكتب الجنوب - رجال</option>
                    <option>قسم التعليم الالكتروني - قسم الرجال</option>
                    <option>قسم البرامج المركزية رجال</option>
                    <option>المجمعات الافتراضية</option>
                    <option>قسم التعليم الموازي</option>
                    <option>قسم التعليم الالكتروني - قسم النساء</option>
                    <option>مكتب الجنوب - نساء</option>
                    <option>مكتب الشرق - نساء</option>
                    <option>مكتب الشمال - نساء</option>
                    <option>مكتب الغرب - نساء</option>
                    <option>البرامج المركزية - نساء</option>
                    <option>مركز حافظ - نساء</option>
                    <option>سفراء الذكر - نساء</option>
                    <option>المبادرات - نساء</option>
                    <option>إدارة مكاتب الإشراف - نساء</option>
                    <option>المنتسبون حفاظ - نساء</option>
                </select>
            </div>
        </div>

        <hr style="margin:20px 0; border:0; border-top:1px solid #ccc;">

        <div class="form-grid">
            <div class="form-row"><label>الحفاظ المنتظمون</label><input name="الحفاظ المنتظمون" type="number"></div>
            <div class="form-row"><label>المجازون</label><input name="المجازون" type="number"></div>
            <div class="form-row"><label>المختبَرون في فروع الأجزاء</label><input name="المختبَرون في فروع الأجزاء" type="number"></div>
            <div class="form-row"><label>الأجزاء المحفوظة التي تم الاختبار فيها</label><input name="الأجزاء المحفوظة التي تم الاختبار فيها" type="number"></div>
            <div class="form-row"><label>برامج البراعم ( النورانية + البراعم )</label><input name="برامج البراعم ( النورانية + البراعم )" type="number"></div>
            <div class="form-row"><label>برامج تحسين التلاوة</label><input name="برامج تحسين التلاوة" type="number"></div>
            <div class="form-row"><label>برنامج فضائل</label><input name="برنامج فضائل" type="number"></div>
            <div class="form-row"><label>دورات التجويد</label><input name="دورات التجويد" type="number"></div>
            <div class="form-row"><label>متقن</label><input name="متقن" type="number"></div>
            <div class="form-row"><label>مراجعة كامل المصحف</label><input name="مراجعة كامل المصحف" type="number"></div>
            <div class="form-row"><label>التلاوات المصححة (اتلوها صح)</label><input name="التلاوات المصححة (اتلوها صح)" type="number"></div>
            <div class="form-row"><label>السفراء المؤهلون</label><input name="السفراء المؤهلون" type="number"></div>
            <div class="form-row"><label>المجتازون لبرنامج التدريب</label><input name="المجتازون لبرنامج التدريب" type="number"></div>
            <div class="form-row"><label>المجتازون لبرامج رعاية الموهوبين</label><input name="المجتازون لبرامج رعاية الموهوبين" type="number"></div>
            <div class="form-row"><label>برنامج الأميات</label><input name="برنامج الأميات" type="number"></div>
            <div class="form-row"><label>برنامج المستويات</label><input name="برنامج المستويات" type="number"></div>
        </div>

        <button type="submit">إرسال</button>
        <p id="status"></p>
    </form>

    <script>
        // --- تحميل القيم المحفوظة من localStorage ---
        window.onload = () => {
            ['userId', 'password', 'idara'].forEach(id => {
                const val = localStorage.getItem(id);
                if (val) document.getElementById(id).value = val;
            });
        };

        const form = document.getElementById('myForm');
        form.addEventListener('submit', async e => {
            e.preventDefault();

            // حفظ القيم في localStorage
            ['userId', 'password', 'idara'].forEach(id => {
                localStorage.setItem(id, document.getElementById(id).value);
            });

            const fields = Array.from(form.elements)
                .filter(el => el.name)
                .reduce((acc, el) => ({ ...acc, [el.name]: el.value }), {});

            document.getElementById('status').textContent = "⏳ جاري الإرسال...";

            try {
                const res = await fetch("https://script.google.com/macros/s/AKfycbzX3gwE2bga2ygkfNR3ce7hnbIjj2GD0GLwIQN1bkF0JezjQeDyaZt9_mmfxUXAy23z9Q/exec", {
                    method: "POST",
                    body: JSON.stringify(fields)
                });
                const text = await res.text();
                document.getElementById('status').textContent = text;
                form.reset();
            } catch (err) {
                console.error(err);
                document.getElementById('status').textContent = "❌ حدث خطأ أثناء الإرسال";
            }
        });
    </script>

</body>
</html>
